---
icon: arrows-to-eye
---

# Recon

<details>

<summary><mark style="color:red;"><strong><code>Check-List</code></strong></mark></summary>

* [ ] <mark style="color:purple;">Check</mark> <mark style="color:orange;">**`robots.txt`**</mark>
* [ ] <mark style="color:purple;">Check</mark> <mark style="color:orange;">**`.git`**</mark>
* [ ] <mark style="color:purple;">Use</mark> <mark style="color:orange;">**`TRACE`**</mark> <mark style="color:purple;">method</mark>
* [ ] <mark style="color:purple;">Force error messages</mark>

</details>

***

{% hint style="info" %}
## <mark style="color:orange;">`TRACE`</mark> <mark style="color:purple;">method</mark>

<mark style="color:red;">**`Checking for Cross-Site Tracing (XST) – Bypassing HttpOnly Cookies`**</mark>

* <mark style="color:purple;">If</mark> <mark style="color:orange;">**`TRACE`**</mark> <mark style="color:purple;">is enabled and the response</mark> <mark style="color:purple;"></mark><mark style="color:purple;">**reflects cookies**</mark><mark style="color:purple;">, an attacker can bypass the</mark> <mark style="color:orange;">**`HttpOnly`**</mark> <mark style="color:purple;">flag.</mark>
* <mark style="color:purple;">Normally,</mark> <mark style="color:orange;">**`HttpOnly`**</mark> <mark style="color:purple;">prevents JavaScript from accessing cookies, but</mark> <mark style="color:orange;">**`TRACE`**</mark>**&#x20;**<mark style="color:purple;">**can leak them**</mark> <mark style="color:purple;"></mark><mark style="color:purple;">if not properly restricted.</mark>

{% code title="POC" %}
```sh
curl -X TRACE https://target.com -H "Test: XST"
```
{% endcode %}

* <mark style="color:purple;">If the response includes the custom header,</mark> <mark style="color:orange;">**`TRACE`**</mark>**&#x20;**<mark style="color:purple;">**is enabled**</mark><mark style="color:purple;">.</mark>
* <mark style="color:purple;">If it leaks</mark> <mark style="color:orange;">**`Set-Cookie`**</mark> <mark style="color:purple;">headers, it’s</mark> <mark style="color:purple;"></mark><mark style="color:purple;">**a serious security issue**</mark><mark style="color:purple;">.</mark>
* <mark style="color:orange;">**`Bug Bounty Impact`**</mark><mark style="color:purple;">**:**</mark> [<kbd><mark style="color:red;">**Session Hijacking**<mark style="color:red;"></kbd>](main-techniques/session-hijacking.md)&#x20;

***

<mark style="color:red;">**`Finding Internal Headers & Debug Info`**</mark>

<mark style="color:purple;">Some servers return</mark> <mark style="color:purple;"></mark><mark style="color:purple;">**sensitive internal headers**</mark> <mark style="color:purple;"></mark><mark style="color:purple;">when</mark> <mark style="color:orange;">**`TRACE`**</mark> <mark style="color:purple;">is enabled, such as:</mark>

* <mark style="color:orange;">**`X-Forwarded-For`**</mark> <mark style="color:purple;">--> Real client IP leak.</mark>
* <mark style="color:orange;">**`X-Backend-Server`**</mark> <mark style="color:purple;">--> Internal server exposure.</mark>
* <mark style="color:orange;">**`Via`**</mark> <mark style="color:purple;">--> Reveals proxy setup.</mark>

{% code title="POC" %}
```sh
curl -X TRACE https://target.com
```
{% endcode %}

* <mark style="color:purple;">Look for unusual headers in the response, which might reveal</mark> <mark style="color:purple;"></mark><mark style="color:purple;">**backend infrastructure details**</mark><mark style="color:purple;">.</mark>
* <mark style="color:orange;">**`Bug Bounty Impact`**</mark><mark style="color:purple;">**:**</mark> <mark style="color:red;">**`Information Disclosure`**</mark>

***

<mark style="color:red;">**`Finding WAF / Security Device Bypasses`**</mark>

* <mark style="color:purple;">Some</mark> <mark style="color:orange;">**`WAFs`**</mark>**&#x20;**<mark style="color:purple;">**don’t inspect**</mark>**&#x20;**<mark style="color:orange;">**`TRACE`**</mark>**&#x20;**<mark style="color:purple;">**requests**</mark> <mark style="color:purple;"></mark><mark style="color:purple;">properly.</mark>
* <mark style="color:purple;">You can use</mark> <mark style="color:orange;">**`TRACE`**</mark> <mark style="color:purple;">to test</mark> <mark style="color:purple;"></mark><mark style="color:purple;">**whether**</mark>**&#x20;**<mark style="color:orange;">**`WAF`**</mark>**&#x20;**<mark style="color:purple;">**protections apply to certain endpoints**</mark><mark style="color:purple;">.</mark>

{% code title="POC" overflow="wrap" %}
```sh
curl -X TRACE https://target.com/index.php --data "payload=<script>alert(1)</script>"
```
{% endcode %}

* <mark style="color:purple;">If</mark> <mark style="color:orange;">**`TRACE`**</mark> <mark style="color:purple;">reflects the payload, but normal requests are blocked, the</mark> <mark style="color:orange;">**`WAF`**</mark> <mark style="color:purple;">**is bypassable**</mark><mark style="color:purple;">.</mark>

***

<mark style="color:red;">**`Checking for Cross-Origin Attacks`**</mark>

* <mark style="color:purple;">If</mark> <mark style="color:orange;">**`TRACE`**</mark> <mark style="color:purple;">is enabled, it might allow</mark> <mark style="color:red;">**`same-origin policy (SOP)`**</mark>**&#x20;**<mark style="color:purple;">**bypasses**</mark><mark style="color:purple;">.</mark>
* <mark style="color:purple;">Some older browsers or misconfigured</mark> <mark style="color:orange;">**`CORS`**</mark> <mark style="color:purple;">setups can be exploited if</mark> <mark style="color:orange;">**`TRACE`**</mark> <mark style="color:purple;">echoes requests cross-origin.</mark>
{% endhint %}

***

{% hint style="info" %}
### <mark style="color:purple;">Browser</mark> <mark style="color:orange;">`DevTools`</mark>

{% code title="Show devtools" %}
```
[CTRL+SHIFT+I] or [F12]
```
{% endcode %}

{% code title="Show Network tab" %}
```
[CTRL+SHIFT+E]
```
{% endcode %}

{% code title="Show Console tab" %}
```
[CTRL+SHIFT+K]
```
{% endcode %}
{% endhint %}

***

{% hint style="info" %}
### <mark style="color:purple;">Bypass</mark> <mark style="color:orange;">`User-Agent`</mark> <mark style="color:purple;">filtering</mark>

* <mark style="color:purple;">Use</mark> [<mark style="color:orange;">**`HTTPBin`**</mark>](https://httpbin.io/user-agent) <mark style="color:purple;">to check the</mark> <mark style="color:orange;">**`User-Agent`**</mark> <mark style="color:purple;">from any client.</mark>
* <mark style="color:purple;">Experiment with those</mark> <mark style="color:orange;">**`User-Agent`**</mark><mark style="color:purple;">**:**</mark>&#x20;

{% code overflow="wrap" lineNumbers="true" %}
```
Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36
Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:124.0) Gecko/20100101 Firefox/124.0
Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36 Edg/123.0.2420.81
Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36 OPR/109.0.0.0
Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36
Mozilla/5.0 (Macintosh; Intel Mac OS X 14.4; rv:124.0) Gecko/20100101 Firefox/124.0
Mozilla/5.0 (Macintosh; Intel Mac OS X 14_4_1) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
Mozilla/5.0 (Macintosh; Intel Mac OS X 14_4_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36 OPR/109.0.0.0
Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36
Mozilla/5.0 (X11; Linux i686; rv:124.0) Gecko/20100101 Firefox/124.0
```
{% endcode %}
{% endhint %}

{% hint style="info" %}
## <mark style="color:purple;">Website Fingerprinting</mark>

* <mark style="color:purple;">Use</mark> [<mark style="color:orange;">**`Wappalyzer`**</mark>](https://www.wappalyzer.com/)
* <mark style="color:purple;">Or in the command line:</mark>

```bash
whatweb -v 10.10.10.121
```

{% code title="Website banners" %}
```sh
curl -IL https://www.inlanefreight.com
```
{% endcode %}
{% endhint %}

***

{% hint style="info" %}
## <mark style="color:orange;">`SSL`</mark> <mark style="color:purple;">Certificates</mark>

* <mark style="color:purple;">Use</mark> <mark style="color:orange;">**`openssl`**</mark> <mark style="color:purple;">to get the certificate's info:</mark>

{% code overflow="wrap" %}
```sh
echo | openssl s_client -showcerts -servername 10.10.10.124 -connect 10.10.10.124:443 2>/dev/null | openssl x509 -inform pem -noout -text
```
{% endcode %}

{% code title="Grep for subdomains" overflow="wrap" %}
```sh
echo | openssl s_client -showcerts -servername 10.10.10.124 -connect 10.10.10.124:443 2>/dev/null | openssl x509 -inform pem -noout -text | grep DNS | tr "," "\n" | cut -d: -f2
```
{% endcode %}

* <mark style="color:purple;">Create a custom wordlist with the subdomains to fuzz for response codes and gain a general idea of the content:</mark>

```sh
 ffuf -c -w domains -u https://FUZZ
```

***

* <mark style="color:purple;">When working with</mark> <mark style="color:orange;">**`HTTPS`**</mark> <mark style="color:purple;">is good practice to</mark> <mark style="color:purple;">validate the</mark> <mark style="color:orange;">**`SSL/TLS`**</mark> <mark style="color:purple;">version and ciphers in use:</mark>

{% code overflow="wrap" %}
```sh
openssl s_client -connect 10.10.10.124:443 -servername 10.10.10.124 -showcerts
```
{% endcode %}

* <mark style="color:purple;">You can follow up with the</mark> <mark style="color:orange;">**`-cipher`**</mark> <mark style="color:purple;">flag to specify the cipher suites you're interested in:</mark>

{% code overflow="wrap" %}
```sh
openssl s_client -connect 10.10.10.124:443 -servername 10.10.10.124 -cipher ECDHE-RSA-AES256-GCM-SHA384
```
{% endcode %}

***

* <mark style="color:purple;">Check if the server implements</mark> <mark style="color:orange;">**`HSTS`**</mark> <mark style="color:purple;">by looking for it's header</mark><mark style="color:purple;">**:**</mark>

```sh
curl -I https://10.10.10.124
```
{% endhint %}

***



