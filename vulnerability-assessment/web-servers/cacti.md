---
description: Apache - PHP
---

# ðŸŒµ Cacti

{% embed url="https://github.com/Cacti/cacti" %}
Main Repo
{% endembed %}

{% tabs %}
{% tab title="Configure MariaDB" %}
{% hint style="info" %}
{% code title="Edit this file" %}
```sh
sudo vim /etc/mysql/mariadb.conf.d/50-server.cnf
```
{% endcode %}

***
{% endhint %}

{% code title="Add this to the end of the file" %}
```
collation-server = utf8mb4_unicode_ci
max_heap_table_size = 128M
tmp_table_size = 64M
join_buffer_size = 64M
innodb_file_format = Barracuda
innodb_large_prefix = 1
innodb_buffer_pool_size = 512M
innodb_buffer_pool_instances = 10
innodb_flush_log_at_timeout = 3
innodb_read_io_threads = 32
innodb_write_io_threads = 16
innodb_io_capacity = 5000
innodb_io_capacity_max = 10000
```
{% endcode %}

{% hint style="info" %}
{% code title="Restart Mariadb" %}
```sh
sudo systemctl restart mariadb
```
{% endcode %}

{% code title="Restart Apache" %}
```sh
sudo systemctl restart apache2
```
{% endcode %}
{% endhint %}
{% endtab %}

{% tab title="Configure PHP" %}
{% hint style="info" %}
{% code title="Edit Server config file" %}
```sh
sudo vim /etc/php/7.4/apache2/php.in
```
{% endcode %}

{% code title="Add this" %}
```
date.timezone = US/Central
memory_limit = 512M
max_execution_time = 60
```
{% endcode %}
{% endhint %}

{% hint style="info" %}
{% code title="Edit the CLI config file" %}
```sh
sudo vim /etc/php/7.4/cli/php.ini
```
{% endcode %}

{% code title="Add this to the file" %}
```
date.timezone = US/Central
memory_limit = 512M
max_execution_time = 60
```
{% endcode %}
{% endhint %}
{% endtab %}

{% tab title="Configure Database" %}
{% hint style="info" %}
{% code title="Edit the config file" %}
```sh
sudo vim /opt/cacti/include/config.php
```
{% endcode %}

{% code title="Write your actual values" %}
```
$database_type = "mysql";
$database_default = "cacti";
$database_hostname = "localhost";
$database_username = "cacti";
$database_password = "cacti";
$database_port = "3306";
$database_ssl = false;
```
{% endcode %}
{% endhint %}
{% endtab %}
{% endtabs %}

{% hint style="info" %}
{% code title="Login commands" %}
```sh
sudo mysql -u root -p
```
{% endcode %}

```sh
sudo mariadb -u <user> -pL
```
{% endhint %}

{% tabs %}
{% tab title="Create Database" %}
{% hint style="info" %}
```sql
create database cacti;
```

```sql
GRANT ALL ON cacti.* TO cacti@localhost IDENTIFIED BY 'cacti';
```

```sql
flush privileges;
```

```sql
exit
```
{% endhint %}
{% endtab %}

{% tab title="Create crontab job" %}
{% hint style="info" %}
{% code title="Edit this file" %}
```sh
sudo vim /etc/cron.d/cacti
```
{% endcode %}

{% code title="Scheduler entry" %}
```
*/5 * * * * www-data php /opt/cacti/poller.php > /dev/null 2>&1
```
{% endcode %}
{% endhint %}
{% endtab %}

{% tab title="Create Log file" %}
{% hint style="info" %}
{% code title="Use touch" %}
```sh
sudo touch /opt/cacti/log/cacti.log
```
{% endcode %}
{% endhint %}
{% endtab %}

{% tab title="Permissions" %}
{% hint style="info" %}
{% code title="Give writetable permissions to user" %}
```sh
sudo chown -R www-data:www-data /opt/cacti/
```
{% endcode %}
{% endhint %}
{% endtab %}
{% endtabs %}

<details>

<summary><mark style="color:purple;"><strong>Add a new site</strong></mark></summary>

{% code title="Edit the config file" %}
```sh
sudo vim /etc/apache2/sites-available/cacti.conf
```
{% endcode %}

{% code title="Use this configuration" %}
```
Alias /cacti /opt/cacti

  <Directory /opt/cacti>
      Options +FollowSymLinks
      AllowOverride None
      <IfVersion >= 2.3>
      Require all granted
      </IfVersion>
      <IfVersion < 2.3>
      Order Allow,Deny
      Allow from all
      </IfVersion>

   AddType application/x-httpd-php .php

<IfModule mod_php.c>
      php_flag magic_quotes_gpc Off
      php_flag short_open_tag On
      php_flag register_globals Off
      php_flag register_argc_argv On
      php_flag track_vars On
      # this setting is necessary for some locales
      php_value mbstring.func_overload 0
      php_value include_path .
 </IfModule>

  DirectoryIndex index.php
</Directory>
```
{% endcode %}

{% code title="Enable the site" %}
```sh
sudo a2ensite cacti
```
{% endcode %}

</details>
