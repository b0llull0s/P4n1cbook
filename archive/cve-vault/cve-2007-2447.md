---
description: Samba 3.0.20 < 3.0.25rc3 - Remote Code Execution
---

# CVE-2007-2447

<mark style="color:yellow;">**Samba 3.0.2x > 3.0.25rc3**</mark>**&#x20;**<mark style="color:purple;">**-**</mark>**&#x20;**<mark style="color:red;">**Remote Code Execution**</mark>**&#x20;**<mark style="color:purple;">**-**</mark>**&#x20;**<mark style="color:orange;">**Python**</mark><mark style="color:purple;">**/**</mark><mark style="color:orange;">**Metasploit**</mark>

<mark style="color:purple;">**Vulnerability**</mark><mark style="color:purple;">: metacharacters involving the (</mark><mark style="color:yellow;">1</mark><mark style="color:purple;">)</mark> <mark style="color:yellow;">SamrChangePassword</mark> <mark style="color:purple;">function, when the "</mark><mark style="color:yellow;">username map script</mark><mark style="color:purple;">"</mark> <mark style="color:yellow;">smb.conf</mark> <mark style="color:purple;">option is enabled, and allows remote authenticated users to execute commands via shell</mark> <mark style="color:yellow;">metacharacters</mark> <mark style="color:purple;">involving other</mark> <mark style="color:yellow;">MS-RPC</mark> <mark style="color:purple;">functions in the (</mark><mark style="color:yellow;">2</mark><mark style="color:purple;">)</mark> <mark style="color:red;">remote printer</mark> <mark style="color:purple;">and (</mark><mark style="color:yellow;">3</mark><mark style="color:purple;">)</mark> <mark style="color:red;">file share management</mark><mark style="color:purple;">.</mark>

<mark style="color:purple;">**Score:**</mark>**&#x20;**<mark style="color:blue;">**CVSS v2.0**</mark><mark style="color:purple;">**:**</mark>**&#x20;**<mark style="color:yellow;">**`6`**</mark>**&#x20;**<mark style="color:purple;">**//**</mark>**&#x20;**<mark style="color:blue;">**CVSS v3.x**</mark><mark style="color:purple;">**:**</mark>**&#x20;**<mark style="color:yellow;">**`N/A`**</mark>

<mark style="color:purple;">**Shows on:**</mark>

* &#x20;<mark style="color:green;">**HTB - Lame**</mark>

<mark style="color:purple;">**POC:**</mark>

{% embed url="https://www.exploit-db.com/exploits/16320" %}

{% embed url="https://github.com/amriunix/CVE-2007-2447" %}

<mark style="color:purple;">**Resources:**</mark>

{% embed url="https://nvd.nist.gov/vuln/detail/CVE-2007-2447" %}

{% embed url="https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2007-2447" %}
