---
description: Pkexec - Pwnkit - Local Privilege Escalation
---

# CVE-2021-4034

<mark style="color:yellow;">**Pwnkit, Polkit**</mark>** **<mark style="color:purple;">**-**</mark>** **<mark style="color:red;">**Local Privilege Escalation**</mark>** **<mark style="color:purple;">**-**</mark> <mark style="color:orange;">**`Python`**</mark> <mark style="color:purple;">**-**</mark> <mark style="color:blue;">**Redhat**</mark>

<mark style="color:purple;">**Vulnerability -->**</mark>** **<mark style="color:yellow;">**pkexec**</mark>** **<mark style="color:purple;">**/**</mark>&#x20;

<mark style="color:purple;">The</mark> <mark style="color:yellow;">**pkexec**</mark> <mark style="color:purple;">application is a</mark> <mark style="color:yellow;">**setuid**</mark> <mark style="color:purple;">tool designed to allow unprivileged users to run commands as privileged users according predefined policies. The current version of</mark> <mark style="color:yellow;">**pkexec**</mark> <mark style="color:purple;">doesn't handle the calling parameters count correctly and ends trying to execute environment variables as commands.</mark>

<mark style="color:purple;">**Score:**</mark>** **<mark style="color:blue;">**CVSS v2.0**</mark><mark style="color:purple;">**:**</mark>** **<mark style="color:yellow;">**`7.2`**</mark>** **<mark style="color:purple;">**//**</mark>** **<mark style="color:blue;">**CVSS v3.x**</mark><mark style="color:purple;">**:**</mark>** **<mark style="color:yellow;">**`7.8`**</mark>

<mark style="color:purple;">**Shows on:**</mark>

* <mark style="color:green;">**HTB-Fulcrum**</mark>

```bash
#Look for it 
find / -perm -4000 -type f 2>/dev/null
```

### <mark style="color:purple;">POC:</mark>

{% embed url="https://github.com/joeammond/CVE-2021-4034" %}

### <mark style="color:purple;">Resources:</mark>

{% embed url="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4034" %}

{% embed url="https://nvd.nist.gov/vuln/detail/cve-2021-4034" %}
