# ðŸŒµ Cacti

Cacti is an open-source, web-based network monitoring and graphing tool designed as a front-end application for the open-source, industry-standard data logging tool RRDtool. Cacti allow a user to poll services at predetermined intervals and graph the resulting data.

GitHub repository:

{% embed url="https://github.com/Cacti/cacti" %}

#### Requirements:

```
#Install Apache & PHP
sudo apt install -y apache2 php-mysql libapache2-mod-php
#Install PHP Extensions
sudo apt install -y php-xml php-ldap php-mbstring php-gd php-gmp
#Install MariaDB
sudo apt install -y mariadb-server mariadb-client
Install SNMP
sudo apt install -y snmp php-snmp rrdtool librrds-perl


```

Configure mariadb:

```
sudo vim /etc/mysql/mariadb.conf.d/50-server.cnf

#Add the following at the end of the file:

collation-server = utf8mb4_unicode_ci
max_heap_table_size = 128M
tmp_table_size = 64M
join_buffer_size = 64M
innodb_file_format = Barracuda
innodb_large_prefix = 1
innodb_buffer_pool_size = 512M
innodb_buffer_pool_instances = 10
innodb_flush_log_at_timeout = 3
innodb_read_io_threads = 32
innodb_write_io_threads = 16
innodb_io_capacity = 5000
innodb_io_capacity_max = 10000

#Restart
sudo systemctl restart mariadb
```

* PHP file Configuration

```
sudo vim /etc/php/7.4/apache2/php.ini
```

```
date.timezone = US/Central
memory_limit = 512M
max_execution_time = 60
```

```
sudo vim /etc/php/7.4/cli/php.ini
```

```
date.timezone = US/Central
memory_limit = 512M
max_execution_time = 60
```

* Create Database

```
sudo mysql -u root -p
```

```
create database cacti;
GRANT ALL ON cacti.* TO cacti@localhost IDENTIFIED BY 'cacti';
flush privileges;
exit
```

```
sudo mysql -u root -p mysql < /usr/share/mysql/mysql_test_data_timezone.sql
```

```
sudo mysql -u root -p
GRANT SELECT ON mysql.time_zone_name TO cacti@localhost;
flush privileges;
exit
```

**Install Cacti**

* Download Cacti

```
#make a directory
sudo mkdir /opt/cacti
#cd in
git get
```

* Configure Database

```
sudo mysql -u root -p cacti < /opt/cacti/cacti.sql
sudo vim /opt/cacti/include/config.php

# make sure these values reflect your actual database/host/user/password
$database_type = "mysql";
$database_default = "cacti";
$database_hostname = "localhost";
$database_username = "cacti";
$database_password = "cacti";
$database_port = "3306";
$database_ssl = false;
```

* Create a crontab file to schedule the polling job.

```
sudo vim /etc/cron.d/cacti
# Add the following scheduler entry in the crontab so that Cacti can poll every five minutes
*/5 * * * * www-data php /opt/cacti/poller.php > /dev/null 2>&1
```

* Create a new site for the Cacti tool

```
sudo vim /etc/apache2/sites-available/cacti.conf
```

Use the following configuration

```
Alias /cacti /opt/cacti

  <Directory /opt/cacti>
      Options +FollowSymLinks
      AllowOverride None
      <IfVersion >= 2.3>
      Require all granted
      </IfVersion>
      <IfVersion < 2.3>
      Order Allow,Deny
      Allow from all
      </IfVersion>

   AddType application/x-httpd-php .php

<IfModule mod_php.c>
      php_flag magic_quotes_gpc Off
      php_flag short_open_tag On
      php_flag register_globals Off
      php_flag register_argc_argv On
      php_flag track_vars On
      # this setting is necessary for some locales
      php_value mbstring.func_overload 0
      php_value include_path .
 </IfModule>

  DirectoryIndex index.php
</Directory>
```

Enable the created site

```
sudo a2ensite cacti
```

Restart Apache services.

```
sudo systemctl restart apache2
```

Create a log file for Cacti and allow the Apache user (www-data) to write data into the Cacti directory.

```
sudo touch /opt/cacti/log/cacti.log
sudo chown -R www-data:www-data /opt/cacti/
```

* Visit the below URL to begin the installation of Cacti

[http://ip/cacti](http://ip/cacti)

Username: admin\\\
Password: admin

After you log in it will ask you to change the password.
